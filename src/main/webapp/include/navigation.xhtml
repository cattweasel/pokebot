<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	
<ui:fragment>
	<script type="text/javascript">
	
	var navigationItems = [];
	
	navigationItems.push({
		text: '#{msgs.navigation_dashboard}',
		iconCls: 'icon-dashboard',
		handler: function() {
			document.location = '#{request.contextPath}/';
		}
	});
	
	navigationItems.push({
		text: '#{msgs.navigation_help}',
		iconCls: 'icon-help',
		handler: function() {
			document.location = '#{request.contextPath}/help.jsf';
		}
	});
	
	</script>
</ui:fragment>

<ui:fragment rendered="#{base.loggedInUser ne null and base.loggedInUser.hasCapability('SystemAdministrator')}">
	<script type="text/javascript">
	
	navigationItems.push({
		xtype: 'splitbutton',
		text: '#{msgs.navigation_monitor}',
		iconCls: 'icon-monitor',
		handler: function () {
	        this.showMenu();
	    },
	    menu: [{
	    		text: '#{msgs.navigation_monitor_user_list}',
	    		iconCls: 'icon-list',
	    		handler: function() {
	    			document.location = '#{request.contextPath}/monitor/list.jsf';
	    		}
	    }, {
	    		text: '#{msgs.navigation_monitor_user_map}',
	    		iconCls: 'icon-map',
	    		handler: function() {
	    			document.location = '#{request.contextPath}/monitor/map.jsf';
	    		}
    		}, {
	    		text: '#{msgs.navigation_monitor_audit_log}',
	    		iconCls: 'icon-audit',
	    		handler: function() {
	    			document.location = '#{request.contextPath}/monitor/audit.jsf';
	    		}
	    }]
	});
	
	</script>
</ui:fragment>

<ui:fragment>
	<script type="text/javascript">
	
	navigationItems.push("->");
	
	navigationItems.push({
		text: '#{msgs.navigation_donate}',
		iconCls: 'icon-donate',
		handler: function() {
			document.getElementById("donate-form").submit();
		}
	});
	
	</script>
</ui:fragment>

<ui:fragment rendered="#{base.loggedInUser eq null}">
	<script type="text/javascript">
	
	navigationItems.push({
		text: '#{msgs.navigation_login}',
		iconCls: 'icon-login',
		handler: function() {
			document.location = '#{request.contextPath}/login.jsf';
		}
	});
	
	</script>
</ui:fragment>

<ui:fragment rendered="#{base.loggedInUser ne null}">
	<script type="text/javascript">
	
	navigationItems.push({
		text: '#{msgs.navigation_settings}',
		iconCls: 'icon-settings',
		handler: function() {
			document.location = '#{request.contextPath}/settings.jsf';
		}
	});
	
	navigationItems.push({
		text: '#{msgs.navigation_logout}',
		iconCls: 'icon-logout',
		handler: function() {
			document.getElementById('logout-form:logout-button').click();
		}
	});
	
	</script>
</ui:fragment>

<ui:fragment>
	<script type="text/javascript">
	
	Ext.onReady(function() {
		
		Ext.create("Ext.toolbar.Toolbar", {
  			renderTo: Ext.get('navigation'),
  			items: navigationItems
		});
		
	});
	
	</script>
</ui:fragment>

<ui:fragment rendered="#{base.loggedInUser ne null}">
	<h:form id="logout-form">
		<h:commandButton id="logout-button" action="#{base.logout}" style="display:none" />
	</h:form>
</ui:fragment>

<ui:fragment>
	<form id="donate-form" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
		<input type="hidden" name="cmd" value="_s-xclick" />
		<input type="hidden" name="hosted_button_id" value="Y9NNRSURV5VCL" />
	</form>
</ui:fragment>

</html>
